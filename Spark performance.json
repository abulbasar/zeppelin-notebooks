{"paragraphs":[{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","editorHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1508559765625_-1731277401","id":"20171021-095245_37662497","dateCreated":"2017-10-21T09:52:45+0530","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5159","text":"spark","dateUpdated":"2017-10-21T09:53:11+0530","dateFinished":"2017-10-21T09:53:12+0530","dateStarted":"2017-10-21T09:53:11+0530","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res8: org.apache.spark.sql.SparkSession = org.apache.spark.sql.SparkSession@c4f4873\n"}]}},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1508559791455_1414090830","id":"20171021-095311_495721988","dateCreated":"2017-10-21T09:53:11+0530","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5273","text":"// Define a simple benchmark util function\ndef benchmark(name: String)(f: => Unit) {\n  val startTime = System.nanoTime\n  f\n  val endTime = System.nanoTime\n  println(s\"Time taken in $name: \" + (endTime - startTime).toDouble / 1000000000 + \" seconds\")\n}","dateUpdated":"2017-10-21T09:59:41+0530","dateFinished":"2017-10-21T09:59:41+0530","dateStarted":"2017-10-21T09:59:41+0530","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"benchmark: (name: String)(f: => Unit)Unit\n"}]}},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1508560181271_-659789464","id":"20171021-095941_667975711","dateCreated":"2017-10-21T09:59:41+0530","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5355","text":"spark.conf.set(\"spark.sql.codegen.wholeStage\", false)\n\nbenchmark(\"Spark 1.6\") {\n  spark.range(1000L * 1000 * 1000).selectExpr(\"sum(id)\").show()\n}","dateUpdated":"2017-10-21T10:00:27+0530","dateFinished":"2017-10-21T10:00:44+0530","dateStarted":"2017-10-21T10:00:27+0530","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------------+\n|           sum(id)|\n+------------------+\n|499999999500000000|\n+------------------+\n\nTime taken in Spark 1.6: 16.222433988 seconds\n"}]}},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1508560193662_10858517","id":"20171021-095953_1332377381","dateCreated":"2017-10-21T09:59:53+0530","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5436","text":"spark.conf.set(\"spark.sql.codegen.wholeStage\", true)\n\nbenchmark(\"Spark 2.0\") {\n  spark.range(1000L * 1000 * 1000).selectExpr(\"sum(id)\").show()\n}","dateUpdated":"2017-10-21T10:01:22+0530","dateFinished":"2017-10-21T10:01:24+0530","dateStarted":"2017-10-21T10:01:22+0530","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------------+\n|           sum(id)|\n+------------------+\n|499999999500000000|\n+------------------+\n\nTime taken in Spark 2.0: 0.731013574 seconds\n"}]}},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1508560282790_664317036","id":"20171021-100122_479255721","dateCreated":"2017-10-21T10:01:22+0530","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5562","text":"// This config turns off whole stage code generation, effectively changing the execution path to be similar to Spark 1.6.\nspark.conf.set(\"spark.sql.codegen.wholeStage\", false)\n\nbenchmark(\"Spark 1.6\") {\n  spark.range(1000L * 1000 * 1000).join(spark.range(1000L).toDF(), \"id\").count()\n}","dateUpdated":"2017-10-21T10:01:42+0530","dateFinished":"2017-10-21T10:03:00+0530","dateStarted":"2017-10-21T10:01:42+0530","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Time taken in Spark 1.6: 76.8990238 seconds\n"}]}},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1508560302801_422710051","id":"20171021-100142_612906152","dateCreated":"2017-10-21T10:01:42+0530","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5645","text":"// This config turns on whole stage code generation (default behaviour in Spark 2.0).\nspark.conf.set(\"spark.sql.codegen.wholeStage\", true)\n\nbenchmark(\"Spark 2.2\") {\n  spark.range(1000L * 1000 * 1000).join(spark.range(1000L).toDF(), \"id\").count()\n}","dateUpdated":"2017-10-21T10:14:48+0530","dateFinished":"2017-10-21T10:14:49+0530","dateStarted":"2017-10-21T10:14:48+0530","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Time taken in Spark 2.2: 0.529421538 seconds\n"}]}},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1508560407386_-417845347","id":"20171021-100327_1823283818","dateCreated":"2017-10-21T10:03:27+0530","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5720","text":"spark.range(1000L * 1000 * 1000).join(spark.range(1000L).toDF(), \"id\").selectExpr(\"count(*)\").explain(true)","dateUpdated":"2017-10-21T10:03:58+0530","dateFinished":"2017-10-21T10:03:59+0530","dateStarted":"2017-10-21T10:03:58+0530","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"== Parsed Logical Plan ==\n'Project [unresolvedalias('count(1), Some(<function1>))]\n+- Project [id#145L]\n   +- Join Inner, (id#145L = id#148L)\n      :- Range (0, 1000000000, step=1, splits=Some(4))\n      +- Range (0, 1000, step=1, splits=Some(4))\n\n== Analyzed Logical Plan ==\ncount(1): bigint\nAggregate [count(1) AS count(1)#161L]\n+- Project [id#145L]\n   +- Join Inner, (id#145L = id#148L)\n      :- Range (0, 1000000000, step=1, splits=Some(4))\n      +- Range (0, 1000, step=1, splits=Some(4))\n\n== Optimized Logical Plan ==\nAggregate [count(1) AS count(1)#161L]\n+- Project\n   +- Join Inner, (id#145L = id#148L)\n      :- Range (0, 1000000000, step=1, splits=Some(4))\n      +- Range (0, 1000, step=1, splits=Some(4))\n\n== Physical Plan ==\n*HashAggregate(keys=[], functions=[count(1)], output=[count(1)#161L])\n+- Exchange SinglePartition\n   +- *HashAggregate(keys=[], functions=[partial_count(1)], output=[count#163L])\n      +- *Project\n         +- *BroadcastHashJoin [id#145L], [id#148L], Inner, BuildRight\n            :- *Range (0, 1000000000, step=1, splits=4)\n            +- BroadcastExchange HashedRelationBroadcastMode(List(input[0, bigint, false]))\n               +- *Range (0, 1000, step=1, splits=4)\n"}]}},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1508560438884_-1438538207","id":"20171021-100358_1774208481","dateCreated":"2017-10-21T10:03:58+0530","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5825","text":"val loadCsv = spark.read.options(Map(\"header\" -> \"true\", \"inferSchema\" -> \"true\")).csv(_:String)","dateUpdated":"2017-10-21T10:09:00+0530","dateFinished":"2017-10-21T10:09:01+0530","dateStarted":"2017-10-21T10:09:00+0530","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"loadCsv: String => org.apache.spark.sql.DataFrame = <function1>\n"}]}},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1508560573105_-497241538","id":"20171021-100613_688975201","dateCreated":"2017-10-21T10:06:13+0530","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5906","text":"val basePath = \"/data/ml-latest\"\nval movies = loadCsv(s\"$basePath/movies.csv\").cache()\nval ratings = loadCsv(s\"$basePath/ratings.csv\").cache()\n\nmovies.count\nratings.count","dateUpdated":"2017-10-21T10:10:03+0530","dateFinished":"2017-10-21T10:11:14+0530","dateStarted":"2017-10-21T10:10:03+0530","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"basePath: String = /data/ml-latest\nmovies: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [movieId: int, title: string ... 1 more field]\nratings: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [userId: int, movieId: int ... 2 more fields]\nres34: Long = 45843\nres35: Long = 26024289\n"}]}},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1508560672046_-1897621910","id":"20171021-100752_1830100547","dateCreated":"2017-10-21T10:07:52+0530","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:6013","text":"val moviesAgg = ratings.alias(\"t1\")\n.join(movies.alias(\"t2\"), col(\"t1.movieId\") === col(\"t2.movieId\"))\n.groupBy(\"t1.movieId\",\"title\")\n.agg(avg(\"rating\").alias(\"rating_avg\"), count(\"*\").alias(\"rating_count\"))\n.filter(\"rating_count >=100\")\n.orderBy(desc(\"rating_avg\"))\n.limit(10)","dateUpdated":"2017-10-21T10:15:50+0530","dateFinished":"2017-10-21T10:15:51+0530","dateStarted":"2017-10-21T10:15:50+0530","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"moviesAgg: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [movieId: int, title: string ... 2 more fields]\n"}]}},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1508560988821_-886057399","id":"20171021-101308_1433173065","dateCreated":"2017-10-21T10:13:08+0530","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:6178","text":"spark.conf.set(\"spark.sql.codegen.wholeStage\", true)\nbenchmark(\"Spark 2.2\") {\n  moviesAgg.show()\n}","dateUpdated":"2017-10-21T10:16:32+0530","dateFinished":"2017-10-21T10:16:38+0530","dateStarted":"2017-10-21T10:16:32+0530","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+--------------------+-----------------+------------+\n|movieId|               title|       rating_avg|rating_count|\n+-------+--------------------+-----------------+------------+\n| 159817| Planet Earth (2006)|4.478779840848806|         754|\n|    318|Shawshank Redempt...|4.429014514393623|       91082|\n| 170705|Band of Brothers ...|4.394366197183099|         284|\n|    858|Godfather, The (1...|4.339810758717364|       57070|\n|     50|Usual Suspects, T...|4.300188962561792|       59271|\n| 100044| Human Planet (2011)|4.271573604060913|         197|\n|    527|Schindler's List ...|4.266530696698294|       67662|\n|   1221|Godfather: Part I...|4.263475012950189|       36679|\n|   2019|Seven Samurai (Sh...|4.255073602972702|       13994|\n|    904|  Rear Window (1954)|4.232552144363722|       21335|\n+-------+--------------------+-----------------+------------+\n\nTime taken in Spark 2.2: 5.765156995 seconds\n"}]}},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1508561156313_-360289019","id":"20171021-101556_1700230967","dateCreated":"2017-10-21T10:15:56+0530","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:6396","text":"spark.conf.set(\"spark.sql.codegen.wholeStage\", false)\nbenchmark(\"Spark 1.6\") {\n  moviesAgg.show()\n}","dateUpdated":"2017-10-21T10:16:09+0530","dateFinished":"2017-10-21T10:16:22+0530","dateStarted":"2017-10-21T10:16:10+0530","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+--------------------+-----------------+------------+\n|movieId|               title|       rating_avg|rating_count|\n+-------+--------------------+-----------------+------------+\n| 159817| Planet Earth (2006)|4.478779840848806|         754|\n|    318|Shawshank Redempt...|4.429014514393623|       91082|\n| 170705|Band of Brothers ...|4.394366197183099|         284|\n|    858|Godfather, The (1...|4.339810758717364|       57070|\n|     50|Usual Suspects, T...|4.300188962561792|       59271|\n| 100044| Human Planet (2011)|4.271573604060913|         197|\n|    527|Schindler's List ...|4.266530696698294|       67662|\n|   1221|Godfather: Part I...|4.263475012950189|       36679|\n|   2019|Seven Samurai (Sh...|4.255073602972702|       13994|\n|    904|  Rear Window (1954)|4.232552144363722|       21335|\n+-------+--------------------+-----------------+------------+\n\nTime taken in Spark 1.6: 11.707721875 seconds\n"}]}},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1508561169963_-283308591","id":"20171021-101609_746828856","dateCreated":"2017-10-21T10:16:09+0530","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:6479"}],"name":"Spark performance","id":"2CW7HWD9W","angularObjects":{"2CYDVVCT5:shared_process":[],"2CXNNVJGA:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}